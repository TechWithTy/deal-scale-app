

# Run test suite with coverage. Continue even if it fails.
if ! pnpm run test:coverage; then
	echo "[pre-commit] Coverage run failed; continuing without blocking commit."
fi

# Execute security scans (Trivy + Opengrep + OWASP). Continue even if they fail.
if ! pnpm run security:scan; then
	echo "[pre-commit] Security scan failed; continuing without blocking commit."
fi

# Archive coverage, security, and Lighthouse reports into timestamped history folders.
pnpm run archive:coverage
pnpm run archive:security
pnpm run archive:reports

# Run lint-staged last to format/stage code changes.
npx lint-staged
